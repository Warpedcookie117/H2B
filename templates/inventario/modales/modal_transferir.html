<!-- Modal Transferir Inventario (UNIVERSAL PARA AMBAS VISTAS) -->
<div id="modalTransferir"
     class="modal-overlay hidden fixed inset-0 bg-black/40 flex items-center justify-center z-50">

    <div id="modalTransferirContent"
         class="modal-content bg-white w-full max-w-xl rounded-xl shadow-2xl p-6
                transition-all duration-300 opacity-0 z-[999]">

        <!-- Encabezado -->
        <h2 class="text-2xl font-bold text-gray-900 mb-6 text-center">
            Transferir inventario
        </h2>

        <!-- Información dinámica del producto -->
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6 space-y-2">

            <p><strong>Producto:</strong>
                <span id="transferir_producto_nombre"
                      class="font-semibold text-gray-800"></span>
            </p>

            <p><strong>Cantidad en origen:</strong>
                <span id="cantidad_origen_label"
                      class="text-red-700 font-bold"></span>
            </p>

            <p><strong>Cantidad en destino:</strong>
                <span id="cantidad_destino_label"
                      class="text-blue-700 font-bold"></span>
            </p>

        </div>

        <!-- Formulario -->
        <form id="formTransferir"
              method="POST"
              action="{% url 'inventario:transferir_inventario' %}"
              onsubmit="confirmarTransferir(event)"
              class="space-y-6">

            {% csrf_token %}

            <input type="hidden" name="producto_id">
            <input type="hidden" name="origen_id">

            <!-- ❌ YA NO USAMOS destino_id -->
            <!-- <input type="hidden" name="destino_id" id="destino_id"> -->

            <!-- Destino -->
            <div>
                <label class="font-semibold mb-2 block">Transferir a la ubicación</label>

                <!-- ⭐ CORRECCIÓN CRÍTICA: name="destino" -->
                <select id="destino_select"
                        name="destino"
                        class="w-full border border-gray-300 rounded-lg px-4 py-2 text-lg
                               focus:ring-blue-500 focus:border-blue-500">
                    <option value="">Selecciona una ubicación</option>

                    {% for u in ubicaciones %}
                        {% if u.id != ubicacion.id %}
                            <option value="{{ u.id }}">{{ u.nombre }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>

            <!-- Cantidad -->
            <div>
                <label class="font-semibold mb-2 block">Cantidad a transferir</label>

                <input type="number"
                       name="cantidad"
                       min="1"
                       class="w-full border border-gray-300 rounded-lg px-4 py-2 text-lg
                              focus:ring-blue-500 focus:border-blue-500"
                       placeholder="Ingresa la cantidad"
                       required>
            </div>

            <!-- Botones -->
            <div class="flex justify-end gap-3 pt-4">

                <button type="button"
                        onclick="cerrarModal('modalTransferir')"
                        class="px-5 py-2 rounded-lg bg-gray-600 text-white hover:bg-gray-700 transition font-semibold">
                    Cancelar
                </button>

                <button type="submit"
                        class="px-5 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition font-semibold">
                    Transferir
                </button>

            </div>

        </form>
    </div>
</div>